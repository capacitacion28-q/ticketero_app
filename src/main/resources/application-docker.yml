# Configuración para Docker Compose con PostgreSQL
spring:
  application:
    name: sistema-ticketero
  
  # Configuración PostgreSQL para Docker
  datasource:
    url: jdbc:postgresql://postgres:5432/ticketero_db
    username: ${DATABASE_USER:ticketero_user}
    password: ${DATABASE_PASSWORD:ticketero_pass}
    driver-class-name: org.postgresql.Driver
  
  # Configuración JPA/Hibernate para PostgreSQL
  jpa:
    hibernate:
      ddl-auto: validate  # Validar schema con Flyway
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
  
  # Flyway habilitado para PostgreSQL
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    validate-on-migrate: true

# Configuración de Schedulers
scheduler:
  message:
    fixed-rate: ${SCHEDULER_MESSAGE_RATE:60000}
  queue:
    fixed-rate: ${SCHEDULER_QUEUE_RATE:5000}

# Configuración Telegram Bot API
telegram:
  bot-token: ${TELEGRAM_BOT_TOKEN:dummy-token-change-me}
  api-url: https://api.telegram.org/bot
  timeout: ${TELEGRAM_TIMEOUT:30000}

# Configuración de Reintentos
retry:
  telegram:
    max-attempts: 3
    backoff:
      initial-delay: 30000
      multiplier: 2.0
      max-delay: 120000

# Configuración de Auditoría
audit:
  retention-days: ${AUDIT_RETENTION_DAYS:2555}
  batch-size: ${AUDIT_BATCH_SIZE:1000}

# Configuración de Colas
queue:
  timeout:
    no-show-minutes: ${NO_SHOW_TIMEOUT:5}
  priority:
    order: "CRITICA,PREFERENCIAL,EMPRESARIAL,GENERAL"
  advisor:
    max-concurrent: ${MAX_CONCURRENT_TICKETS:3}

# Configuración de Logging
logging:
  level:
    com.example.ticketero: INFO
    org.springframework.retry: DEBUG
    org.flywaydb: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

# Configuración del servidor
server:
  port: ${SERVER_PORT:8080}